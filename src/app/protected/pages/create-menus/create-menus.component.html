<div class="p-4 ml-6">
  <h1 class="text-teal-500">
  {{ menu ? 'Editar' : 'Crear' }}  Menú
  </h1>
</div>

<div class="flex flex-row p-4">

  <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">

      <!-- Form -->
    <div class="col-span-1 sm:col-span-2 w-full p-4">
      <form autocomplete="off"
            [formGroup]="createMenuForm"
            (ngSubmit)="saveMenu()">

        <mat-form-field appearance="legacy" class="w-80 sm:w-96">
          <mat-label class="text-teal-500 text-lg p-2">{{ menu ? 'Actualizar' : 'Añadir' }} Nombre</mat-label>
          <div class="p-2">
            <input matInput placeholder="Nombre" formControlName="name">
          </div>
          <!-- <mat-icon matSuffix>perm_identity</mat-icon> -->
        </mat-form-field>
        <br>

        <mat-form-field appearance="legacy" class="w-80 sm:w-96">
          <mat-label class="text-teal-500 text-lg p-2">{{ menu ? 'Actualizar' : 'Añadir' }} Descripción</mat-label>
          <div class="p-2">
            <!-- <input matInput placeholder="subtítulo" formControlName="description"> -->
            <textarea cdkTextareaAutosize matInput placeholder="Descripción" formControlName="description"></textarea>
          </div>
          <!-- <mat-icon matSuffix>perm_identity</mat-icon> -->
        </mat-form-field>
        <br>

        <mat-form-field appearance="legacy" class="w-80 sm:w-96">
          <mat-label class="text-teal-500 text-lg p-2">{{ menu ? 'Actualizar' : 'Añadir' }} Número</mat-label>
          <div class="p-2">
            <input type="number" matInput placeholder="número de menú" formControlName="number">
          </div>
          <!-- <mat-icon matSuffix>perm_identity</mat-icon> -->
        </mat-form-field>
        <br>

        <mat-form-field appearance="legacy" class="w-80 sm:w-96">
          <mat-label class="text-teal-500 text-lg p-2">{{ menu ? 'Actualizar' : 'Añadir' }} Comensales</mat-label>
          <div class="p-2">
            <input type="number" matInput placeholder="número de comensales" formControlName="diners">
          </div>
          <!-- <mat-icon matSuffix>perm_identity</mat-icon> -->
        </mat-form-field>
        <br>

        <mat-form-field appearance="legacy" class="w-60 sm:w-80">
          <mat-label class="text-teal-500 text-md p-2">Seleccionar platos</mat-label>
          <div class="p-2">
            <mat-select [formControl]="newDish">
              <mat-option *ngFor="let dish of dishesList" [value]="dish._id">
                {{ dish.name }}
              </mat-option>
            </mat-select>
          </div>
        </mat-form-field>

        <!-- class="bg-teal-500 text-white rounded-sm p-2 px-6 ml-4"  -->
        <button
          class="mt-3 ml-2 w-20"
          (click)="addDish()"
          type="button">
            <!-- Añadir -->
            <mat-icon class="relative bottom-1 bg-teal-500 text-white w-full border-2 border-teal-500 scale-150 rounded-sm flex pb-6 pr-6">add</mat-icon>
        </button>

        <hr class="my-4 py-4">

        <!-- Remove a dish -->
        <div formArrayName="dishes">
          <h3 class="text-teal-500">Lista de platos</h3>

          <div class="input-group"
               *ngFor="let dish of dishesArray.controls; let i = index"
          >

            <div *ngFor="let dishToDelete of dishesList">

              <div *ngIf="dishToDelete._id === dish.value" class="relative top-5">
                  {{ i + 1 }} - {{ dishToDelete.name | uppercase }}
              </div>

            </div>
            <input
              class="form-control invisible w-64 sm:w-80"
              [formControlName]="i"
              readonly="readonly"
            >

              <button
                class="text-red-500 mb-4"
                (click)="removeDish(i)"
                type="button"
              >
                <mat-icon class="relative bottom-1 hover:text-white hover:bg-red-500 rounded-sm ml-6 sm:ml-8">delete</mat-icon>
               <!-- Eliminar -->
              </button>

          </div>

        </div>

        <hr class="my-4 py-4">

        <div *ngIf="menu" class="flex flex-row gap-4">
          <button
            class="bg-blue-500 text-white p-4 rounded-sm w-full"
            type="button"
            [disabled]="createMenuForm.invalid"
            (click)="updateMenu()"
          >
            Actualizar
          </button>

          <button
            class="bg-red-500 text-white p-4 rounded-sm w-full"
            type="button"
            (click)="removeMenu()"
          >
            Eliminar
          </button>
        </div>

        <div *ngIf="!menu">
          <button
            class="bg-blue-500 text-white p-4 rounded-sm"
            type="submit"
            [disabled]="createMenuForm.invalid"
          >
           Crear producto
          </button>
        </div>

      </form>

    </div>

    <div class="col-span-1 sm:col-span-1 sm:order-last -order-1">

      <!-- Image picker component -->
        <app-image-picker
          [menu]="menu"
          (onShareImage)="addImage( $event )"
        >

        </app-image-picker>

    </div>

  </div>


</div>
